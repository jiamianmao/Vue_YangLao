webpackJsonp([15,20],{"+QNF":function(t,e,n){(t.exports=n("BkJT")(!1)).push([t.i,"",""])},W5TO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"rolefunc",props:["title","roleId","ownFuncs","all"],data:function(){return{allFunc:[],chooseFunc:[],defaultProps:{label:"name",children:"children"},havedFuncs:this.ownFuncs}},components:{},created:function(){this.allFunc=this.makeTree(this.all||[]),Array.prototype.push.apply(this.chooseFunc,this.ownFuncs)},mounted:function(){},methods:{cliConfirm:function(){this.$emit("pop-click",this.chooseFunc,this.roleId)},cliCancle:function(){this.$emit("pop-click")},makeTree:function(t){for(var e=[],n=[],o=t.filter(function(t){return 0===t.pid}),l=function(l){e=t.filter(function(t){return t.pid===o[l].id}),n.push({name:o[l].name,children:e})},a=0;a<o.length;a++)l(a);return n},getNode:function(){var t=this;this.chooseFunc=[],this.$refs.tree.getCheckedNodes(!0).forEach(function(e){return t.chooseFunc.push(e.id)}),console.log(this.chooseFunc)}},computed:{ifChange:function(){return this.havedFuncs.sort().toString()===this.chooseFunc.sort().toString()}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popUp"},[n("el-dialog",{staticClass:"dialog",attrs:{title:"配置菜单权限",visible:!0,"show-close":!1,"lock-scroll":!0,"close-on-click-modal":!1,modal:!0}},[n("div",{staticClass:"tranfer"},[n("el-row",[n("el-col",{attrs:{span:10}},[n("el-tree",{ref:"tree",attrs:{data:t.allFunc,"show-checkbox":"","default-expand-all":"","node-key":"id","default-checked-keys":t.havedFuncs,props:t.defaultProps},on:{"check-change":t.getNode}})],1)],1)],1),t._v(" "),n("el-button",{on:{click:t.cliCancle}},[t._v("取 消")]),t._v(" "),t.ifChange?t._e():n("el-button",{attrs:{type:"primary"},on:{click:t.cliConfirm}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var a=n("/Xao")(o,l,!1,function(t){n("qbYd")},null,null);e.default=a.exports},qbYd:function(t,e,n){var o=n("+QNF");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("8bSs")("6bc053be",o,!0)},v5qc:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("STY9"),l=n("rppN"),a=n("bwmV"),c=n("W5TO"),i={data:function(){return{roleInfo:{id:"",name:"",status:"",type:"",typeShow:""},typeMap:{0:"平台",1:"机构",2:"政府"},funList:[],funcIdArr:[],showDialog:!1,showFuncDialog:!1,allFunc:[]}},components:{rolePoPup:a.default,rolefunc:c.default,PageContainer:l.a,ChunkLabel:o.a},created:function(){this.roleInfo.id=this.$route.query.id,this.getData(),this.getAllFunc()},methods:{goBack:function(){this.$router.back()},editRoleInfo:function(){this.showDialog=!0},editRolefunc:function(){this.showFuncDialog=!0},dialogClick:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(2===e.length){var o=arguments[0];if(""===o.name)return void alert("请填写角色名称");if(""===o.state)return void alert("请选择角色状态");if(""===o.type)return void alert("请选择角色类型");o.hasOwnProperty("typeShow")&&delete o.typeShow,this.$http.post("http://ums.17link.cc/role/saveRole.do",o).then(function(t){alert("操作成功")}).catch(function(t){return console.log})}this.showDialog=!1},funcClick:function(){var t=this;if(arguments.length>0){var e=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1];this.$http.post("http://ums.17link.cc/roleFunc/updateFuncByRoleId.do",{roleId:n,funcIds:e}).then(function(e){t.getData()}).catch(function(t){return console.log})}this.showFuncDialog=!1},getAllFunc:function(){var t=this;this.$http.get("http://ums.17link.cc/func/getAllFunc.do").then(function(e){t.allFunc=e.data.data.funcs,console.log(t.allFunc)}).catch(function(t){return console.log})},getData:function(){var t=this;this.$http.post("http://ums.17link.cc/role/getRoleByRoleId.do","id="+this.roleInfo.id).then(function(e){var n=e.data.data;t.roleInfo=n.role,t.funList=n.funcs,t.roleInfo.typeShow=t.typeMap[t.roleInfo.type],t.funcIdArr=[],t.funList.forEach(function(e){t.funcIdArr.push(e.id)})}).catch(function(t){return console.log})}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("page-container",{attrs:{title:"角色详情","show-back-btn":""}},[n("chunk-label",{attrs:{title:"基本信息"}},[n("el-button",{attrs:{type:"plain",size:"small",icon:"el-icon-edit"},on:{click:t.editRoleInfo}},[t._v("修改")])],1),t._v(" "),n("el-row",[n("el-form",{staticClass:"info-container",attrs:{"label-width":"100px","label-position":"left"}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"角色编码"}},[n("span",[t._v(t._s(t.roleInfo.id))])]),t._v(" "),n("el-form-item",{attrs:{label:"角色名称"}},[n("span",[t._v(t._s(t.roleInfo.name))])]),t._v(" "),n("el-form-item",{attrs:{label:"角色状态"}},[n("span",[t._v(t._s(1==t.roleInfo.state?"正常":t.roleInfo.state?"失效":"正常"))])]),t._v(" "),n("el-form-item",{attrs:{label:"角色类型"}},[n("span",[t._v(t._s(t.roleInfo.typeShow))])])],1)],1)],1),t._v(" "),n("chunk-label",{attrs:{title:"菜单权限"}},[n("el-button",{attrs:{type:"plain",icon:"el-icon-setting",size:"small"},on:{click:t.editRolefunc}},[t._v("配置")])],1),t._v(" "),n("el-table",{staticClass:"table",staticStyle:{width:"80%"},attrs:{data:t.funList,border:""}},[n("el-table-column",{attrs:{prop:"pName",label:"系统名称",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"mask",label:"菜单编码",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"level",label:"菜单级别",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"菜单名称",align:"center"}})],1),t._v(" "),t.showDialog?n("rolePoPup",{attrs:{title:"修改角色",roleInfo:t.roleInfo},on:{"pop-click":t.dialogClick}}):t._e(),t._v(" "),t.showFuncDialog?n("rolefunc",{attrs:{ownFuncs:t.funcIdArr,roleId:t.roleInfo.id,all:t.allFunc},on:{"pop-click":t.funcClick}}):t._e()],1)},staticRenderFns:[]},s=n("/Xao")(i,r,!1,null,null,null);e.default=s.exports}});