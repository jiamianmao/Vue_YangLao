webpackJsonp([10,19],{BBGg:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"\n.popUp .dialog {\n  /*position: absolute;*/\n  /*top: 300px;*/\n  /*left: 30%;*/\n}\n",""])},DVf6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"popup",props:["show"],data:function(){return{rules:{name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],mask:[{required:!0,message:"请输入菜单掩码",trigger:"blur"}]},curform:{num:"",desc:""},visitform:{scope:5,desc:""},formLabelWidth:"120px",cancelReasonList:[]}},created:function(){this.show?(this.title="请选择取消原因",this.getCancelReasonList()):this.title="添加回访记录"},methods:{cliConfirm:function(){var t={};t=this.show?this.curform:this.visitform,this.$emit("pop-click",t,this.show)},cliCancle:function(){this.$emit("pop-click")},getCancelReasonList:function(){var t=this;this.$http.get("http://mp.17link.cc/order/cancelReasonDict").then(function(e){var a=e.data.data;t.cancelReasonList=a.cancelReason}).catch(function(t){return alert(t)})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popUp"},[a("el-dialog",{staticClass:"dialog",attrs:{title:t.title,visible:!0,"show-close":!1,"lock-scroll":!0,"close-on-click-modal":!1,modal:!0}},[t.show?a("el-form",{attrs:{model:t.curform,rules:t.rules}},[a("el-radio-group",{model:{value:t.curform.num,callback:function(e){t.$set(t.curform,"num",e)},expression:"curform.num"}},t._l(t.cancelReasonList,function(e,i){return a("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.text))])})),t._v(" "),4==t.curform.num?a("el-form-item",{attrs:{label:"","label-width":t.formLabelWidth}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.curform.desc,callback:function(e){t.$set(t.curform,"desc",e)},expression:"curform.desc"}})],1):t._e()],1):a("el-form",{attrs:{model:t.visitform,rules:t.rules}},[a("el-form-item",{attrs:{label:"服务满意度","label-width":t.formLabelWidth,prop:"scope"}},[a("el-rate",{model:{value:t.visitform.scope,callback:function(e){t.$set(t.visitform,"scope",e)},expression:"visitform.scope"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"回访记录","label-width":t.formLabelWidth,prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.visitform.desc,callback:function(e){t.$set(t.visitform,"desc",e)},expression:"visitform.desc"}})],1)],1),t._v(" "),a("el-button",{on:{click:t.cliCancle}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.cliConfirm}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var o=a("/Xao")(i,r,!1,function(t){a("lSGf")},null,null);e.default=o.exports},DwdG:function(t,e,a){var i=a("uhwH");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("06ca8c64",i,!0)},fub0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("DVf6"),r=a("rppN"),o=a("7XyB"),n={data:function(){return{orderId:"",state:"",stateDisplay:"",buttonContent:"",ifShowButton:!1,ifShow:!0,orderInfo:{},orderSummaryInfo:[],logList:[],star:{commentScore:5},urlList:[],backVisitRecordList:[],show:!1,showDialog:!1,orderStateDict:["待接单","已接单","待分派","已取消","已完成"],totalDuration:0,totalAmount:0,serviceRecord:{},type:window._dataInfo.type,timeFormat:o.format,source:"",textarea:"",mp3List:{}}},components:{popup:i.default,PageContainer:r.a},created:function(){this.orderId=this.$route.query.orderId,this.state=parseInt(this.$route.query.state),this.stateDisplay=this.orderStateDict[this.state-1],this.getTitle(this.state),this.source=this.$route.query.source;var t=this;this.getOrderInfo(function(){t.getOrderSummaryInfo(),5===t.state&&(t.getServiceRecord(),t.getBackVisitRecordList(),t.getEvaluativeInfo())}),this.getLogList()},methods:{getTitle:function(t){switch(t){case 1:this.buttonContent="取消订单",this.ifShowButton=!0,this.show=!0;break;case 2:this.buttonContent="取消订单",this.show=!0;break;case 3:this.buttonContent="取消订单",this.ifShowButton=!0,this.show=!0;break;case 4:this.ifShow=!1;break;case 5:this.buttonContent="订单回访",this.show=!1}},control:function(){this.showDialog=!0},dialogClick:function(t,e){var a=this;if(!t)return this.showDialog=!1,!1;if(e){if(!t.num)return alert("请选择取消原因"),!1;var i=this;this.$http.post("http://mp.17link.cc/order/cancelOrder",{orderId:this.orderId,cancelReasonId:t.num,cancelReasonText:t.text,source:1}).then(function(t){return i.$router.back()}).catch(function(t){return alert(t)})}else this.$http.post("http://mp.17link.cc/order/addBackVisit","orderId="+this.orderId+"&score="+t.scope+"&remark="+t.desc).then(function(t){a.$router.go(0)}).catch(function(t){return alert(t)});this.showDialog=!1},changeSerPerson:function(){this.$router.push({path:"/integratedMana/oReassignMent",query:{orderId:this.orderId,source:this.source}})},getOrderInfo:function(t){var e=this;this.$http.get("http://mp.17link.cc/order/info?orderId="+this.orderId).then(function(a){var i=a.data.data;e.orderInfo=i,t&&t()}).catch(function(t){return alert(t)})},getOrderSummaryInfo:function(){var t=this;this.$http.get("http://mp.17link.cc/order/orderSummaryInfo?orderId="+this.orderId).then(function(e){var a=e.data.data;t.orderSummaryInfo=a.orderList,t.orderSummaryInfo.forEach(function(t){t.showCate=t.catePname+">"+t.cateName}),t.totalDuration=a.totalDuration,t.totalAmount=a.totalAmount}).catch(function(t){return alert(t)})},getServiceRecord:function(){var t=this;this.$http.get("http://mp.17link.cc/order/serviceRecord?orderId="+this.orderId+"&workerId="+this.orderInfo.workerId).then(function(e){var a=e.data.data;t.serviceRecord=a}).catch(function(t){return alert(t)})},getEvaluativeInfo:function(){var t=this;this.$http.get("http://mp.17link.cc/order/evaluativeInfo?orderId="+this.orderId+"&workerId="+this.orderInfo.workerId).then(function(e){var a=e.data.data;if(a){t.star.commentScore=a.commentScore||5,t.urlList=a.urlList.filter(function(t){return 1===t.type});var i=a.urlList.filter(function(t){return 2===t.type});t.mp3List=i[0]}}).catch(function(t){return alert(t)})},getBackVisitRecordList:function(){var t=this;this.$http.get("http://mp.17link.cc/order/backVisitRecord?orderId="+this.orderId+"&workerId="+this.orderInfo.workerId).then(function(e){var a=e.data.data;t.backVisitRecordList=a,console.log(t.backVisitRecordList)}).catch(function(t){return alert(t)})},getLogList:function(){var t=this;this.$http.get("http://mp.17link.cc/order/logList?orderId="+this.orderId).then(function(e){var a=e.data.data;t.logList=a,t.logList.forEach(function(t){return t.createTimeShow=Object(o.format)(t.createTime,"YYYY-MM-DD HH:mm:SS")})}).catch(function(t){return alert(t)})},play:function(){console.log(1),this.$refs.audio.play()},down:function(){}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-container",{staticClass:"order-detail",attrs:{title:"订单详情"}},[a("div",{staticClass:"titleHead"},[a("div",{staticClass:"detial-info"},[a("el-row",[a("div",{staticClass:"order-number"},[t._v("\n                    订单号: "+t._s(t.orderId)+"\n                    "),a("el-button",{staticClass:"control-bottom",on:{click:function(e){t.$router.back()}}},[t._v("返回")])],1)]),t._v(" "),1===t.type?a("el-row",{staticClass:"top-button"},[t.ifShow?a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"control-bottom",attrs:{type:"primary"},on:{click:t.control}},[t._v(t._s(t.buttonContent))])],1):t._e(),t._v(" "),t.ifShowButton?a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"control-bottom",attrs:{type:"primary"},on:{click:t.changeSerPerson}},[t._v("改派订单")])],1):t._e()],1):t._e(),t._v(" "),a("el-row",{staticClass:"top-content clearfix"},[a("div",{staticClass:"display"},[t._v("\n                    "+t._s(t.stateDisplay)+"\n                ")]),t._v(" "),a("div",{staticClass:"scope"},[a("el-steps",{attrs:{active:t.state+1,"finish-status":"success","align-center":!0}},[a("el-step",{attrs:{title:"创建订单"}}),t._v(" "),a("el-step",{attrs:{title:"待接单"}}),t._v(" "),a("el-step",{attrs:{title:"已接单"}}),t._v(" "),a("el-step",{attrs:{title:"待分派"}}),t._v(" "),a("el-step",{attrs:{title:"已取消"}}),t._v(" "),a("el-step",{attrs:{title:"已完成"}})],1)],1)]),t._v(" "),a("div",{staticClass:"item-info"},[a("ul",{staticClass:"clearfix"},[a("li",[a("h5",[t._v("订单信息")]),t._v(" "),a("div",{staticClass:"content"},[a("div",[t._v("订单号："+t._s(t.orderId))]),t._v(" "),a("div",[t._v("下单时间："+t._s(t.timeFormat(t.orderInfo.createTime,"YYYY-MM-DD HH:mm:SS")))]),t._v(" "),a("div",[t._v("订单状态："+t._s(t.orderInfo.state))]),t._v(" "),a("div",[t._v("养老机构："+t._s(t.orderInfo.orgName))])])]),t._v(" "),a("li",[a("h5",[t._v("老人信息")]),t._v(" "),a("div",{staticClass:"content"},[a("div",[t._v("姓名："+t._s(t.orderInfo.userName))]),t._v(" "),a("div",[t._v("服务地址："+t._s(t.orderInfo.provinceName+t.orderInfo.cityName+t.orderInfo.districtName+t.orderInfo.streetName+t.orderInfo.community+t.orderInfo.detailedAddress)+"\n                            ")]),t._v(" "),a("div",[t._v("手机："+t._s(t.orderInfo.userMobile))]),t._v(" "),a("div",[t._v("固话："+t._s(t.orderInfo.userPhone))])])]),t._v(" "),a("li",[a("h5",[t._v("服务信息")]),t._v(" "),a("div",{staticClass:"content"},[a("div",[t._v("姓名："+t._s(t.orderInfo.workerName))]),t._v(" "),a("div",[t._v("电话："+t._s(t.orderInfo.workerMobile))]),t._v(" "),a("div",[t._v("职位："+t._s(t.orderInfo.workerPost))])])]),t._v(" "),a("li",{staticClass:"last"},[a("h5",[t._v("订单结算信息")]),t._v(" "),a("div",{staticClass:"content"},[a("div",[t._v("开始时间："+t._s(t.timeFormat(t.orderInfo.serviceTime,"YYYY-MM-DD HH:mm:SS")))])])])])])],1),t._v(" "),a("el-row",{staticClass:"sub-order"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.orderSummaryInfo}},[a("el-table-column",{attrs:{prop:"cateId",label:"品类编号",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"showCate",label:"服务品类",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"duration",label:"品类单位时长/分钟"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price",label:"单价"}}),t._v(" "),a("el-table-column",{attrs:{label:"服务过程照片"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.orderSummaryInfo[e.$index].urlList,function(t){return a("img",{key:t.id,staticClass:"images",attrs:{src:t.picUrl,alt:""}})})}}])})],1),t._v(" "),a("div",{staticClass:"totl"},[a("div",[t._v("订单服务时长："+t._s(t.totalDuration))]),t._v(" "),a("div",[t._v("订单总额："+t._s(t.totalAmount))])])],1),t._v(" "),5===t.state?a("el-row",{staticClass:"serInfo clearfix"},[a("div",{staticClass:"content"},[a("h5",[t._v("服务记录")]),t._v(" "),a("div",{staticClass:"title"},[t._v(" 服务人员："+t._s(t.orderInfo.workerName))])]),t._v(" "),a("ul",{staticClass:"serList clearfix"},[a("li",[t._v("打卡时间: "+t._s(t.timeFormat(t.serviceRecord.signInTime,"YYYY-MM-DD HH:mm:SS")))]),t._v(" "),a("li",[t._v("打卡定位: "+t._s(t.serviceRecord.signInAddress))]),t._v(" "),a("li",[t._v("结束时间: "+t._s(t.timeFormat(t.serviceRecord.signOutTime,"YYYY-MM-DD HH:mm:SS")))]),t._v(" "),a("li",[t._v("结束定位: "+t._s(t.serviceRecord.signOutAddress))])])]):t._e(),t._v(" "),5===t.state?a("el-row",{staticClass:"appraise-info clearfix"},[a("div",{staticClass:"left"},[a("h5",[t._v("评价信息")]),t._v(" "),a("div",{staticClass:"stars"},[a("el-form",{attrs:{model:t.star}},[a("el-form-item",{attrs:{label:"服务满意度","label-width":"134px"}},[a("el-rate",{staticClass:"star-pos",attrs:{disabled:""},model:{value:t.star.commentScore,callback:function(e){t.$set(t.star,"commentScore",t._n(e))},expression:"star.commentScore"}})],1)],1)],1)]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"images"},[t._l(t.urlList,function(t){return a("img",{key:t.id,attrs:{src:t.picUrl,width:"40%"}})}),t._v(" "),a("div",[a("h3",[t._v("评价")]),t._v(" "),a("el-input",{staticClass:"textarea",attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"老人对订单的评价"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1),t._v(" "),a("div",[a("h3",[t._v("录音")]),t._v(" "),a("i",{staticClass:"el-icon-tickets"}),t._v(" "),a("audio",{ref:"audio",staticStyle:{opacity:"0"},attrs:{src:t.mp3List.picUrl}}),t._v(" "),a("a",{staticClass:"btn",on:{click:function(e){e.preventDefault(),t.play(e)}}},[t._v("播放")]),t._v(" "),a("a",{staticClass:"btn",attrs:{href:t.mp3List.picUrl,download:t.mp3List.picUrl}},[t._v("下载")])])],2)])]):t._e(),t._v(" "),5===t.state?a("el-row",[a("div",{staticClass:"left visited-info"},[a("h5",[t._v("回访记录")]),t._v(" "),a("div",{staticClass:"content"},t._l(t.backVisitRecordList,function(e){return a("el-row",{key:e.id},[a("el-col",{attrs:{span:5}},[a("div",[a("h5",[t._v("回访信息：")]),t._v(" "),a("div",[t._v("客服: "+t._s(e.operateUserName))])]),t._v(" "),a("div",[a("div",[t._v(t._s(new Date(e.createTime).toLocaleString()))])])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form",{staticClass:"visited-pos"},[a("el-form-item",[a("el-input",{attrs:{type:"textarea",disabled:!0},model:{value:e.remark,callback:function(a){t.$set(e,"remark",a)},expression:"item.remark"}})],1)],1)],1)],1)}))])]):t._e(),t._v(" "),a("div",{staticClass:"log"},[a("h5",[t._v("操作记录")]),t._v(" "),a("el-row",[a("el-table",{attrs:{data:t.logList,border:""}},[a("el-table-column",{attrs:{prop:"createTimeShow",label:"操作时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createUserName",label:"操作人",width:"250"}})],1)],1)],1)],1),t._v(" "),t.showDialog?a("popup",{attrs:{show:t.show},on:{"pop-click":t.dialogClick}}):t._e()],1)},staticRenderFns:[]};var l=a("/Xao")(n,s,!1,function(t){a("DwdG")},"data-v-776af472",null);e.default=l.exports},lSGf:function(t,e,a){var i=a("BBGg");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("78a2ce7c",i,!0)},uhwH:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,'\n@charset "UTF-8";\n.order-detail[data-v-776af472] {\n  font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1","PingFang SC", "Helvetica Neue", Helvetica, "Hiragino Sans GB", Arial, sans-serif;\n  color: #616D80;\n  border: none !important;\n}\n.order-detail .titleHead > div[data-v-776af472] {\n    padding-left: 10px;\n}\n.order-detail .detial-info[data-v-776af472] {\n    margin-top: -1px;\n    padding: 0 64px 64px 32px;\n}\n.order-detail .detial-info .order-number[data-v-776af472] {\n      margin-top: 32px;\n      font-size: 24px;\n      height: 51px;\n      line-height: 51px;\n}\n.order-detail .detial-info .top-button[data-v-776af472] {\n      background-color: #fff;\n}\n.order-detail .detial-info .top-button .control-bottom[data-v-776af472] {\n        margin-top: 32px;\n}\n.order-detail .detial-info .top-content[data-v-776af472] {\n      background-color: #fff;\n      padding: 90px 0 90px 210px;\n      border-bottom: 1px solid #EFEFEF;\n}\n.order-detail .detial-info .top-content > div[data-v-776af472] {\n        display: inline-block;\n}\n.order-detail .detial-info .top-content .display[data-v-776af472] {\n        font-size: 28px;\n        color: #00A6FC;\n        height: 64px;\n        line-height: 64px;\n}\n.order-detail .detial-info .top-content .scope[data-v-776af472] {\n        width: 50%;\n        margin-left: 118px;\n}\n.order-detail .detial-info .item-info[data-v-776af472] {\n      background-color: #fff;\n      padding: 69px 0px 42px 0px;\n}\n.order-detail .detial-info .item-info ul[data-v-776af472] {\n        background-color: #fff;\n        height: 100%;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n}\n.order-detail .detial-info .item-info ul li[data-v-776af472] {\n          -webkit-box-flex: 1;\n              -ms-flex: 1;\n                  flex: 1;\n          margin-left: 50px;\n          padding-right: 50px;\n          border-right: 1px solid #EFEFEF;\n          font-size: 18px;\n          height: 262px;\n}\n.order-detail .detial-info .item-info ul li h5[data-v-776af472] {\n            margin-bottom: 34px;\n            font-size: 20px;\n            font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1", "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",  Arial, sans-serif;\n}\n.order-detail .detial-info .item-info ul li .content > div[data-v-776af472] {\n            /*height: 30px;*/\n            font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1", "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",  Arial, sans-serif;\n            margin-bottom: 20px;\n}\n.order-detail .detial-info .item-info ul .last[data-v-776af472] {\n          border: none;\n}\n.order-detail .sub-order[data-v-776af472] {\n    margin-bottom: 30px;\n    position: relative;\n    padding-bottom: 70px;\n}\n.order-detail .sub-order .totl[data-v-776af472] {\n      position: absolute;\n      bottom: 0px;\n      right: 300px;\n      font-size: 20px;\n}\n.order-detail .sub-order .totl > div[data-v-776af472] {\n        margin-bottom: 10px;\n}\n.order-detail .sub-order .images[data-v-776af472] {\n      width: 110px;\n      height: 110px;\n      margin-left: 26px;\n      display: inline-block;\n}\n.order-detail .serInfo[data-v-776af472] {\n    border: 1px solid #B2BFD1;\n    padding-bottom: 70px;\n}\n.order-detail .serInfo > div[data-v-776af472] {\n      float: left;\n}\n.order-detail .serInfo .content[data-v-776af472] {\n      margin-right: 258px;\n}\n.order-detail .serInfo .content h5[data-v-776af472] {\n        font-size: 22px;\n        font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1","Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",  Arial, sans-serif;\n        margin-top: 30px;\n        margin-bottom: 44px;\n}\n.order-detail .serInfo .content .title[data-v-776af472] {\n        font-size: 20px;\n}\n.order-detail .serInfo .serList[data-v-776af472] {\n      margin-top: 74px;\n      font-size: 20px;\n}\n.order-detail .serInfo .serList > li[data-v-776af472] {\n        float: left;\n        margin-left: 86px;\n        margin-bottom: 10px;\n}\n.order-detail .appraise-info[data-v-776af472] {\n    border: 1px solid #B2BFD1;\n    border-top: none;\n}\n.order-detail .appraise-info .left h5[data-v-776af472] {\n      margin: 30px 0 14px 0px;\n      font-size: 22px;\n}\n.order-detail .appraise-info .left .stars .star-pos[data-v-776af472] {\n      margin-top: 8px;\n}\n.order-detail .appraise-info .right[data-v-776af472] {\n      margin-top: 48px;\n}\n.order-detail .appraise-info .right .images[data-v-776af472] {\n        width: 100%;\n        height: 216px;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n}\n.order-detail .appraise-info .right .images > div[data-v-776af472] {\n          width: 300px;\n          margin-left: 30px;\n}\n.order-detail .appraise-info .right .images > div h3[data-v-776af472] {\n            margin-bottom: 10px;\n}\n.order-detail .appraise-info .right .images > div i[data-v-776af472] {\n            margin-right: 20px;\n}\n.order-detail .appraise-info .right .images > div .btn[data-v-776af472] {\n            display: inline-block;\n            width: 50px;\n            height: 30px;\n            text-align: center;\n            line-height: 30px;\n            border-radius: 5px;\n            border: 1px solid #333;\n            color: #666;\n}\n.order-detail .appraise-info .right .images img[data-v-776af472] {\n          width: 100px;\n          margin-left: 10px;\n          display: inline-block;\n}\n.order-detail[data-v-776af472],\n  .order-detail .visited-info[data-v-776af472] {\n    border: 1px solid #B2BFD1;\n    border-top: none;\n}\n.order-detail .left h5[data-v-776af472],\n    .order-detail .visited-info .left h5[data-v-776af472] {\n      margin: 30px 0 14px 0px;\n      font-size: 22px;\n}\n.order-detail .right[data-v-776af472],\n    .order-detail .visited-info .right[data-v-776af472] {\n      margin-top: 48px;\n}\n.order-detail .right .images[data-v-776af472],\n      .order-detail .visited-info .right .images[data-v-776af472] {\n        widht: 218px;\n        height: 216px;\n        margin-left: 54px;\n        display: inline-block;\n}\n.order-detail .visited-pos[data-v-776af472],\n    .order-detail .visited-info .visited-pos[data-v-776af472] {\n      margin-top: 26px;\n}\n',""])}});