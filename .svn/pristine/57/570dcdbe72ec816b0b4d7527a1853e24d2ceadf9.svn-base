webpackJsonp([35],{MRb8:function(e,t,n){var a=n("cQHE");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("8bSs")("7e3d8046",a,!0)},Sxrg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("lC5x"),o=n.n(a),r=n("J0Oq"),i=n.n(r),s={created:function(){var e=this;return i()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.userInfo=window._dataInfo,t.next=5,e._loadInstList();case 5:t.sent,e._loadServicerData(e._drawEcharts),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},data:function(){return{loading:!1,myChart:null,formInline:{organization:""},userInfo:null,instList:[],serviceData:[],geoCoordMap:null}},mounted:function(){},methods:{selectChange:function(e){var t=this,n=window._dataInfo.type;console.log(n);var a=void 0;if(0!==n&&1!==n||(a={ids:[e]},console.log(a)),2===n){var o=[];this.instList.forEach(function(e){o.push(e.id)}),a={ids:o}}this.$http.post("http://mp.17link.cc/worker/position",a).then(function(e){t.serviceData=e.data.data,t.geoCoordMap=e.data.geoCoordMap,t._drawEcharts()}).catch(function(e){console.log(e)})},_loadInstList:function(){var e=this;return i()(o.a.mark(function t(){var n,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window._dataInfo.type,a=void 0,0!==n){t.next=10;break}return console.log("超级管理员"),a={cityId:"",provinceId:"",streetId:"",pageNum:1},t.next=7,e.$http.post("http://ums.17link.cc/orgStreet/getOrgByParam.do",a).then(function(t){e.instList=t.data.data.list}).catch(function(e){console.log(e)});case 7:t.sent,t.next=21;break;case 10:if(1!==n){t.next=15;break}console.log("机构"),e.instList.push({id:e.userInfo.orgId,name:e.userInfo.orgName}),t.next=21;break;case 15:if(2!==n){t.next=21;break}return console.log("政府"),a={cityId:e.userInfo.cityId,areaId:e.userInfo.countryId,provinceId:e.userInfo.provinceId,streetId:e.userInfo.streetId,pageNum:1},t.next=20,e.$http.post("http://ums.17link.cc/orgStreet/getOrgByParam.do",a).then(function(t){e.instList=t.data.data.list}).catch(function(e){console.log(e)});case 20:t.sent;case 21:case"end":return t.stop()}},t,e)}))()},_loadServicerData:function(e){var t=this;return i()(o.a.mark(function n(){var a,r,i,s;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=window._dataInfo.type,r=void 0,0===a?(console.log("超级管理员"),r={ids:[]}):1===a?(console.log("机构"),i=t.userInfo.orgId,r={ids:[i]}):2===a&&(console.log("政府"),s=[],t.instList.forEach(function(e){s.push(e.id)}),r={ids:s}),n.next=5,t.$http.post("http://mp.17link.cc/worker/position",r).then(function(e){t.serviceData=e.data.data,t.geoCoordMap=e.data.geoCoordMap}).catch(function(e){console.log(e)});case 5:n.sent,e&&e();case 7:case"end":return n.stop()}},n,t)}))()},_drawEcharts:function(){var e=this;this.$nextTick(function(){e.myChart=echarts.init(document.getElementById("service-map-wrap")),e.loading=!1;var t=e.serviceData,n=e.geoCoordMap,a={backgroundColor:"#404a59",title:{text:"服务人员分布",left:"center",textStyle:{color:"#fff"}},tooltip:{trigger:"item",formatter:function(e){return""+e.name}},bmap:{center:[104.080384,30.656567],zoom:6,roam:!0,mapStyle:{styleJson:[{featureType:"water",elementType:"all",stylers:{color:"#044161"}},{featureType:"land",elementType:"all",stylers:{color:"#004981"}},{featureType:"boundary",elementType:"geometry",stylers:{color:"#064f85"}},{featureType:"railway",elementType:"all",stylers:{visibility:"off"}},{featureType:"highway",elementType:"geometry",stylers:{color:"#004981"}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#005b96",lightness:1}},{featureType:"highway",elementType:"labels",stylers:{visibility:"off"}},{featureType:"arterial",elementType:"geometry",stylers:{color:"#004981"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#00508b"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"green",elementType:"all",stylers:{color:"#056197",visibility:"off"}},{featureType:"subway",elementType:"all",stylers:{visibility:"off"}},{featureType:"manmade",elementType:"all",stylers:{visibility:"off"}},{featureType:"local",elementType:"all",stylers:{visibility:"off"}},{featureType:"arterial",elementType:"labels",stylers:{visibility:"off"}},{featureType:"boundary",elementType:"geometry.fill",stylers:{color:"#029fd4"}},{featureType:"building",elementType:"all",stylers:{color:"#1a5787"}},{featureType:"label",elementType:"all",stylers:{visibility:"off"}}]}},series:[{name:"服务人员",type:"scatter",coordinateSystem:"bmap",data:function(e){for(var t=[],a=0;a<e.length;a++){var o=n[e[a].name];o&&t.push({name:e[a].name,value:o.concat(e[a].value)})}return t}(t),symbolSize:function(e){return 10},label:{normal:{formatter:"{b}",position:"right",show:!0},emphasis:{show:!0}},itemStyle:{normal:{color:function(e){return"2"===e.value[2]?"#ddb926":"#ec361be6"}}}}]};e.myChart.setOption(a)})}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"map-container"},[n("el-form",{staticClass:"demo-form-inline search-wrap",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:"机构选择"}},[n("el-select",{on:{change:e.selectChange},model:{value:e.formInline.organization,callback:function(t){e.$set(e.formInline,"organization",t)},expression:"formInline.organization"}},e._l(e.instList,function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1)],1),e._v(" "),n("div",{attrs:{id:"service-map-wrap"}})],1)},staticRenderFns:[]};var c=n("/Xao")(s,l,!1,function(e){n("MRb8")},"data-v-380cf6d8",null);t.default=c.exports},cQHE:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"\n.map-container[data-v-380cf6d8] {\n  padding: 20px;\n}\n#service-map-wrap[data-v-380cf6d8] {\n  width: 100%;\n  height: 750px;\n  position: relative;\n}\n.anchorBL[data-v-380cf6d8] {\n  display: none;\n}\n",""])}});