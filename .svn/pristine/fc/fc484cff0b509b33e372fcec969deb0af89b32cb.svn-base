webpackJsonp([38],{"1tvv":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={data:function(){return{data:[],defaultProps:{children:"cate",label:"cateName"},dialogFormVisible:!1,formData:{cateId:"",cateName:"",catePid:""},formLabelWidth:"120px",title:"",type:"",id:"",controlType:0,ifDelete:!1,rules:{cateName:{type:"string",length:25,required:!0,message:"请输入品类名称",trigger:"blur"}}}},created:function(){this.getData()},components:{PageContainer:a("rppN").a},methods:{newCategory:function(){this.ifDelete=!1,this.controlType=1,this.title="添加分类",this.dialogFormVisible=!0,this.formData={cateId:"",cateName:"",catePid:""}},edit:function(t,e){this.dialogFormVisible=!0,this.controlType=0,e.cate?(this.formData.catePid="0",this.formData.cateName=e.cateName,this.formData.cateId=e.catePid):(this.formData.catePid=e.catePid,this.formData.cateName=e.cateName,this.formData.cateId=e.cateId),this.title="修改分类"},remove:function(t,e){this.dialogFormVisible=!0,this.controlType=2,this.ifDelete=!0,this.title="删除分类",e.cateId?(this.formData.catePid=e.catePid,this.formData.cateName=e.cateName,this.formData.cateId=e.cateId,this.type=2,this.id=e.cateId):(this.formData.catePid="0",this.formData.cateName=e.cateName,this.formData.cateId=e.catePid,this.type=1,this.id=e.catePid)},renderContent:function(t,e){var a=this,i=e.node,r=e.data,n=e.store;return t("div",{style:"width: 100%;display: flex; justify-content: space-between; padding-right: 20px;"},[t("span",null,[t("span",null,[i.label])]),t("span",null,[t("el-button",{attrs:{size:"mini"},on:{click:function(){return a.edit(n,r)}}},["修改"]),t("el-button",{attrs:{size:"mini"},on:{click:function(){return a.remove(n,r)}}},["删除"])])])},submit:function(){var t=this,e=this.formData;switch(this.controlType){case 0:if(""===e.cateName)return alert("请输入品类名称"),this.ifDelete=!1,this.dialogFormVisible=!1,!1;this.$http.get("http://mp.17link.cc/manage/category/update?cateName="+e.cateName+"&catePid="+e.catePid+"&cateId="+e.cateId).then(function(e){t.getData()}).catch(function(t){return alert(t)});break;case 1:if(""===e.cateName)return alert("请输入品类名称"),this.ifDelete=!1,this.dialogFormVisible=!1,!1;this.$http.get("http://mp.17link.cc/manage/category/add?cateName="+e.cateName+"&catePid="+e.catePid).then(function(e){t.getData()}).catch(function(t){return alert(t)});break;case 2:if(1===this.type){var a=this.data.find(function(e){return e.catePid===t.id});if(console.log(a),!a)return alert("网络异常，请刷新从新操作"),this.ifDelete=!1,this.dialogFormVisible=!1,!1;var i=a.cate;if(i&&i.length&&i.length>0)return alert("无法删除带有小品类的大品类"),this.ifDelete=!1,this.dialogFormVisible=!1,!1}this.$http.get("http://mp.17link.cc/manage/category/delete?id="+this.id+"&type="+this.type).then(function(e){t.getData()}).catch(function(t){return alert(t)})}this.ifDelete=!1,this.dialogFormVisible=!1},getData:function(){var t=this;this.$http.get("http://mp.17link.cc/manage/category/query").then(function(e){var a=e.data.data;t.data=a.list;for(var i=0;i<t.data.length;i++)if(t.data[i].cate&&t.data[i].cate.length&&t.data[i].cate.length>0)for(var r=t.data[i].cate,n=0;n<r.length;n++)r[n].catePid=t.data[i].catePid}).catch(function(t){return alert(t)})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-container",{staticClass:"category",attrs:{title:"品类目录"}},[a("div",{staticClass:"contain"},[a("el-button",{staticClass:"new-role",attrs:{type:"primary",size:"small"},on:{click:t.newCategory}},[t._v("\n            添加品类\n        ")]),t._v(" "),a("div",{staticClass:"list"},[a("el-tree",{staticClass:"tree",attrs:{data:t.data,props:t.defaultProps,"expand-on-click-node":!1,"render-content":t.renderContent}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.formData,rules:t.rules}},[a("el-form-item",{attrs:{label:"品类名称","label-width":"100px",prop:"cateName"}},[a("el-input",{attrs:{disabled:t.ifDelete},model:{value:t.formData.cateName,callback:function(e){t.$set(t.formData,"cateName",e)},expression:"formData.cateName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"大品类","label-width":"100px"}},[a("el-select",{attrs:{disabled:t.ifDelete},model:{value:t.formData.catePid,callback:function(e){t.$set(t.formData,"catePid",e)},expression:"formData.catePid"}},[a("el-option",{attrs:{label:"无",value:"0"}}),t._v(" "),t._l(t.data,function(t){return a("el-option",{key:t.id,attrs:{label:t.cateName,value:t.catePid}})})],2)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=a("/Xao")(i,r,!1,function(t){a("hYkG")},null,null);e.default=n.exports},IluD:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"\n.category .new-role {\n  margin-left: 10px;\n}\n.category .tree {\n  margin-top: 10px;\n  border: 1px solid #d1dbe5;\n}\n.category .tree .el-tree-node {\n    margin: 10px 0;\n    line-height: 28px;\n}\n",""])},hYkG:function(t,e,a){var i=a("IluD");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("e4c901a2",i,!0)}});