webpackJsonp([43],{"6tum":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("rppN"),l={data:function(){return{tableData:[],roleList:[],systerms:[],rules:{},searchForm:{name:"",status:"",type:""},formLabelWidth:"100px",showDialog:!1,showList:!1,typeMap:{0:"平台",1:"机构",2:"政府"}}},components:{rolePoPup:a("bwmV").default,PageContainer:o.a},created:function(){this.getRoleList()},methods:{getRoleList:function(t){var e=this;this.searchForm.name.trim&&(this.searchForm.name=this.searchForm.name.trim()),this.$http.get("http://ums.17link.cc/role/doSearch.do?name="+this.searchForm.name+"&status="+this.searchForm.status+"&type="+this.searchForm.type).then(function(a){var o=a.data.data;e.tableData=o.roles,e.tableData.forEach(function(t){return t.status=1===t.status?"正常":"失效"}),e.tableData.forEach(function(t){return t.typeShow=e.typeMap[t.type]}),t&&t()}).catch(function(t){return console.log})},newRole:function(){this.showDialog=!0},stopRole:function(t,e){this.$agent.post("/role/saveRole.do",{id:e[t].id,name:e[t].name,type:e[t].type,status:"正常"===e[t].status?2:1}).then(function(a){e[t].status="正常"===e[t].status?"失效":"正常"}).catch(function(t){return console.log})},onSubmit:function(){var t=this;this.getRoleList(function(){t.showList=!0})},reSet:function(){this.searchForm={name:"",status:"",type:""}},changeStatus:function(t,e){this.getAdverseStatus(e[t].status)},getAdverseStatus:function(t){if(t)return"正常"===t.trim()?"停用":"失效"===t.trim()?"启用":""},getDisplayStatue:function(t){return"1"===t?"正常":"2"===t?"失效":void 0},dialogClick:function(){var t=this;if(2===arguments.length){var e=arguments[0];if(""===e.name)return void alert("请填写角色名称");if(""===e.state)return void alert("请选择角色状态");if(""===e.type)return void alert("请选择角色类型");e.hasOwnProperty("typeShow")&&delete e.typeShow,this.$http.post("http://ums.17link.cc/role/saveRole.do",e).then(function(e){alert("操作成功"),t.getRoleList()}).catch(function(t){return console.log})}this.showDialog=!1},showRoleInfo:function(t,e){this.$router.push({path:"/pt/roleInfo",query:{id:e[t].id}})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-container",{attrs:{title:"角色管理"}},[a("el-form",{staticClass:"info-container",attrs:{model:t.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"角色名称","label-width":t.formLabelWidth,prop:"roleName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"角色状态","label-width":t.formLabelWidth,prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"失效",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"角色类型","label-width":t.formLabelWidth,prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"平台",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"政府",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"机构",value:"1"}})],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{offset:1,span:8}},[a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:t.onSubmit}},[t._v("筛选\n                    ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-close",type:"primary"},on:{click:t.reSet}},[t._v("重置\n                    ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:t.newRole}},[t._v("添加角色\n                    ")])],1)],1)],1)],1),t._v(" "),a("el-table",{staticClass:"list",attrs:{data:t.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"角色编码",width:"249"}}),t._v(" "),a("el-table-column",{attrs:{prop:"control",label:"角色名称",width:"249"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.showRoleInfo(e.$index,t.tableData)}}},[t._v("\n                    "+t._s(t.tableData[e.$index].name)+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"角色状态",width:"249"}}),t._v(" "),a("el-table-column",{attrs:{prop:"typeShow",label:"角色类型",width:"249"}}),t._v(" "),a("el-table-column",{attrs:{prop:"control",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.stopRole(e.$index,t.tableData)}}},[t._v("\n                    "+t._s(t.getAdverseStatus(t.tableData[e.$index].status))+"\n                ")])]}}])})],1),t._v(" "),t.showDialog?a("div",[a("rolePoPup",{attrs:{title:"添加角色",roleInfo:""},on:{"pop-click":t.dialogClick}})],1):t._e()],1)},staticRenderFns:[]},r=a("/Xao")(l,s,!1,null,null,null);e.default=r.exports}});