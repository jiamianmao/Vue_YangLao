webpackJsonp([26],{elZc:function(e,t,a){var r=a("xJmj");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("8bSs")("1a61be2c",r,!0)},fjC7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("hRKE"),o=a.n(r),n=a("qn+5"),s=a("fEa0"),l=a("M8s3"),i=a("rppN"),c={data:function(){return{userForm:{pageNum:1,pageSize:10,condition:{orgId:"",name:"",mobile:"",sex:"",state:"",createDateFrom:"",createDateTo:"",managerName:window._dataInfo.name,managerId:window._dataInfo.id},serviceArea:{provinceId:"",provinceName:"",cityId:"",cityName:"",zoneId:"",zoneName:"",streetId:"",streetName:""}},serviceAreaMap:{},userInfo:window._dataInfo,type:window._dataInfo.type,tableData:[],showOrg:!1,time:[],totleNum:0}},components:{cityArea:n.a,limitArea:s.a,orgChoose:l.a,PageContainer:i.a},computed:{},created:function(){this.getLists()},methods:{sift:function(){this.userForm.pageSize=10,this.getLists()},changeStatus:function(e,t){var a=this,r=t[e],o=t[e].id,n=1===r.state?2:1;this.$http.post("http://mp.17link.cc/manage/user/stateSwitch","id="+o+"&state="+n).then(function(e){alert("修改成功"),a.getLists()}).catch(function(e){return console.log})},getAdverseStatus:function(e){return e.trim?"正常"===e.trim()?"停用":"启用":"停用"},selectChange:function(e){var t=this.userForm.serviceArea;t.provinceId=e.provinceId,t.provinceName=e.provinceName,t.cityId=e.cityId,t.cityName=e.cityName,t.zoneId=e.areaId,t.zoneName=e.areaName,t.streetId=e.streetId,t.streetName=e.streetName},chooseOrg:function(){this.showOrg=!0},setOrgInfo:function(e){e&&(this.userForm.condition.orgId=e.id,this.userForm.condition.orgName=e.name),this.showOrg=!1},pageChange:function(e){this.userForm.pageNum=e,this.userForm.pageSize=10,this.getLists()},reSet:function(){this.userForm.condition={orgId:"",name:"",mobile:"",sex:"",state:"",createDateFrom:"",createDateTo:"",managerName:window._dataInfo.name,managerId:window._dataInfo.id}},getLists:function(e){var t=this;this.time.length>0&&(this.userForm.condition.createDateFrom=this.time[0].getTime(),this.userForm.condition.createDateTo=this.time[1].getTime()),this.$http.post("http://mp.17link.cc/manage/user/query",this.userForm).then(function(a){var r=a.data.data;console.log(r),t.totleNum=r.count,t.tableData=r.list,t.tableData.forEach(function(e){e.stateShow=1==~~e.state?"失效":"正常",e.sexShow=1==~~e.sex?"男":"女",e.createTimeShow=new Date(e.createTime).toLocaleString()}),e&&e()}).catch(function(e){return console.log})},linkTo:function(e,t){this.$router.push({path:"/integratedMana/operateElderly",query:{id:t[e].id}})},edit:function(e){this.$router.push({path:"/integratedMana/operateElderly",query:{id:e.id}})},add:function(){this.$router.push({path:"/integratedMana/operateElderly"})},getQuery:function(e){var t="";for(var a in e)"object"===o()(e[a])?t+=this.getQuery(e[a]):t+=a+"="+e[a]+"&";return t},getParams:function(e){return e.slice(0,-1)},beforeAvatarUpload:function(e){return 1!==this.type&&this.userForm.condition.orgId?(alert("请先选择服务机构"),!1):e.name.endsWith("xlsx")?void 0:(alert("只接受以 .xlsx 结尾的文件"),!1)},handleAvatarSuccess:function(){0!==arguments[0].errCode&&arguments[0].errMessage&&alert(arguments[0].errMessage),arguments[2].length>=1&&arguments[2].shift()}},watch:{userForm:{deep:!0,handler:function(){var e=this.userForm.serviceArea;this.serviceAreaMap={provinceId:e.provinceId,provinceName:e.provinceName,cityId:e.cityId,cityName:e.cityName,areaId:e.zoneId,areaName:e.zoneName,streetId:e.streetId,streetName:e.streetName}}}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("pageContainer",{staticClass:"org-m",attrs:{title:"老人管理"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"search-table"},[1===e.type?a("el-row",[a("el-col",{attrs:{span:6}},[a("el-button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加老人")])],1)],1):e._e(),e._v(" "),a("el-form",{staticClass:"demo-ruleForm form",attrs:{model:e.userForm,"label-width":"120px"}},[a("el-row",{staticClass:"area"},[0===e.type?a("cityArea",{ref:"area",attrs:{title:"服务区域",curNum:"0"},on:{"select-change":e.selectChange}}):e._e(),e._v(" "),2===e.type?a("limitArea",{on:{"select-change":e.selectChange}}):e._e()],1),e._v(" "),1!==e.type?a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"服务机构"}},[e._v("\n                            "+e._s(e.userForm.condition.orgName)+"\n                            "),a("el-button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.chooseOrg}},[e._v("选择服务机构")])],1)],1)],1):e._e(),e._v(" "),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"老人姓名"}},[a("el-input",{model:{value:e.userForm.condition.name,callback:function(t){e.$set(e.userForm.condition,"name",t)},expression:"userForm.condition.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"老人手机"}},[a("el-input",{model:{value:e.userForm.condition.mobile,callback:function(t){e.$set(e.userForm.condition,"mobile",t)},expression:"userForm.condition.mobile"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"老人性别"}},[a("el-select",{attrs:{placeholder:"请选择机构状态"},model:{value:e.userForm.condition.sex,callback:function(t){e.$set(e.userForm.condition,"sex",t)},expression:"userForm.condition.sex"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"男",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"女",value:"2"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"老人状态"}},[a("el-select",{attrs:{placeholder:"请选择机构状态"},model:{value:e.userForm.condition.state,callback:function(t){e.$set(e.userForm.condition,"state",t)},expression:"userForm.condition.state"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"正常",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"失效",value:"1"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"选择时间范围"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-form-item",[a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:e.sift}},[e._v("筛选")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reSet}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary"}},[a("a",{staticClass:"download",attrs:{download:"",href:"http://mp.17link.cc/manage/user/export?"+e.getParams(e.getQuery(this.userForm))}},[e._v("导出")])]),e._v(" "),1===e.type?a("el-button",{attrs:{icon:"plus",type:"primary"},on:{click:e.add}},[e._v("添加老人")]):e._e()],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-upload",{attrs:{action:"http://mp.17link.cc/manage/user/import",multiple:!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[a("el-button",{attrs:{type:"primary"}},[e._v("导入老人信息")])],1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{staticClass:"temp-download",attrs:{type:"text"}},[a("a",{attrs:{download:"",href:"http://mp.17link.cc/manage/user/template"}},[e._v("获取老人信息模板")])])],1)],1)],1)],1)],1)]),e._v(" "),a("div",{staticClass:"list"},[a("el-table",{staticClass:"list",attrs:{data:e.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"orgName",label:"养老机构",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"residenceProvinceName",label:"省",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"residenceCityName",label:"市",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"residenceZoneName",label:"区县",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"residenceStreetName",label:"街道",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"community",label:"社区",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"control",label:"老人姓名",width:"249"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.linkTo(t.$index,e.tableData)}}},[e._v("\n                        "+e._s(e.tableData[t.$index].name)+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sexShow",label:"性别",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"老人手机",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"固定电话",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTimeShow",label:"创建时间",width:"249"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stateShow",label:"老人状态",width:"249"}}),e._v(" "),1===e.type?a("el-table-column",{attrs:{prop:"control",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.changeStatus(t.$index,e.tableData)}}},[e._v("\n                        "+e._s(e.getAdverseStatus(e.tableData[t.$index].stateShow))+"\n                    ")]),e._v(" "),"正常"===e.tableData[t.$index].stateShow?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.edit(e.tableData[t.$index])}}},[e._v("\n                        修改\n                    ")]):e._e()]}}])}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{"page-size":10,layout:"total, prev, pager, next",total:e.totleNum},on:{"current-change":e.pageChange}})],1),e._v(" "),e.showOrg?a("org-choose",{attrs:{areaData:e.serviceAreaMap},on:{"pop-click":e.setOrgInfo}}):e._e()],1)},staticRenderFns:[]};var p=a("/Xao")(c,m,!1,function(e){a("elZc")},null,null);t.default=p.exports},xJmj:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.org-m .search .head {\n  background-color: #fff;\n}\n.org-m .search .head h5 {\n    padding: 0px 38px 0px 38px;\n    height: 42px;\n    line-height: 42px;\n    font-size: 22px;\n    color: #616d80;\n    border: 1px solid #CAD3DF;\n    border-bottom: none;\n    text-align: center;\n    background-color: #FBFBFB;\n    border-radius: 5px 5px 0 0;\n}\n.org-m .search .search-table {\n  padding-top: 10px;\n  margin-top: -1px;\n}\n.org-m .search .search-table .button {\n    margin-left: 31px;\n    margin-bottom: 10px;\n}\n.org-m .list {\n  margin-top: 32px;\n}\n.org-m .download {\n  width: 100%;\n  color: #fff;\n}\n",""])}});