webpackJsonp([14],{"0t/8":function(e,t,a){var r=a("WLi6");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("8bSs")("ed0903a4",r,!0)},FZm0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("4YfN"),i=a.n(r),n=a("lC5x"),s=a.n(n),l=a("J0Oq"),o=a.n(l),c={name:"cityArea",props:["curNum","ifEdit","area","title","check"],data:function(){return{areaData:{provinceId:"",provinceName:"",cityId:"",cityName:"",areaId:"",areaName:"",streetId:"",streetName:""},provinces:[],cities:[],areas:[],streets:[],ruls:[]}},created:function(){this.getProvinces()},methods:{getProvinces:function(){var e=this;this.$http.get("http://ums.17link.cc/city/getAllProvince.do",{withCredentials:!0}).then(function(t){e.provinces=t.data.data.list}).catch(function(e){return alert(e)})},selectChange:function(){var e=this;if(this.areaData.provinceId){var t=this.provinces.filter(function(t){return t.id===e.areaData.provinceId});t.length>0&&t[0].name&&(this.areaData.provinceName=t[0].name)}if(this.areaData.cityId){var a=this.cities.filter(function(t){return t.id===e.areaData.cityId});a.length>0&&a[0].name&&(this.areaData.cityName=a[0].name)}if(this.areaData.areaId){var r=this.areas.filter(function(t){return t.id===e.areaData.areaId});r.length>0&&r[0].name&&(this.areaData.areaName=r[0].name)}if(this.areaData.streetId){var i=this.streets.filter(function(t){return t.id===e.areaData.streetId});i.length>0&&i[0].name&&(this.areaData.streetName=i[0].name)}"-1"===this.areaData.provinceId&&(this.areaData.provinceId="",this.areaData.provinceName=""),"-1"===this.areaData.cityId&&(this.areaData.cityId="",this.areaData.cityName=""),"-1"===this.areaData.areaId&&(this.areaData.areaId="",this.areaData.areaName=""),"-1"===this.areaData.streetId&&(this.areaData.streetId="",this.areaData.streetName=""),this.$emit("select-change",this.areaData,this.curNum)},reSet:function(){this.areaData={provinceId:"",provinceName:"",cityId:"",cityName:"",areaId:"",areaName:"",streetId:"",streetName:""}}},watch:{area:function(){this.areaData=this.serviceArea},"areaData.provinceId":function(){var e=this;if(this.areaData.cityId="",this.areaData.cityName="",this.areaData.areaId="",this.areaData.areaName="",this.areaData.streetId="",this.areaData.streetName="",!this.areaData.provinceId)return!1;this.$http.get("http://ums.17link.cc/city/getCityByPid.do?pid="+this.areaData.provinceId,{withCredentials:!0}).then(function(t){e.cities=t.data.data.list,e.selectChange()}).catch(function(e){console.log(e)})},"areaData.cityId":function(){var e=this;if(this.areaData.areaId="",this.areaData.areaName="",this.areaData.streetId="",this.areaData.streetName="",!this.areaData.cityId)return!1;this.$http.get("http://ums.17link.cc/city/getCityByPid.do?pid="+this.areaData.cityId,{withCredentials:!0}).then(function(t){e.areas=t.data.data.list,e.selectChange()}).catch(function(e){return alert(e)})},"areaData.areaId":function(){var e=this;if(this.areaData.streetId="",this.areaData.streetName="",!this.areaData.areaId)return!1;this.$http.get("http://ums.17link.cc/city/getCityByPid.do?pid="+this.areaData.areaId,{withCredentials:!0}).then(function(t){e.streets=t.data.data.list,e.selectChange()}).catch(function(e){return alert(e)})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-form-item",{attrs:{label:this.title}},[a("el-col",{attrs:{span:5}},[a("el-select",{attrs:{disabled:e.ifEdit,placeholder:"请选择"},model:{value:e.areaData.provinceId,callback:function(t){e.$set(e.areaData,"provinceId",t)},expression:"areaData.provinceId"}},[a("el-option",{attrs:{label:"无",value:"-1"}}),e._v(" "),e._l(e.provinces,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),a("el-col",{staticClass:"marl",attrs:{span:4}},[a("el-select",{attrs:{disabled:e.ifEdit,placeholder:"请选择"},model:{value:e.areaData.cityId,callback:function(t){e.$set(e.areaData,"cityId",t)},expression:"areaData.cityId"}},[a("el-option",{attrs:{label:"无",value:"-1"}}),e._v(" "),e._l(e.cities,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),a("el-col",{staticClass:"marl",attrs:{span:4}},[a("el-select",{attrs:{disabled:e.ifEdit,placeholder:"请选择"},model:{value:e.areaData.areaId,callback:function(t){e.$set(e.areaData,"areaId",t)},expression:"areaData.areaId"}},[a("el-option",{attrs:{label:"无",value:"-1"}}),e._v(" "),e._l(e.areas,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),a("el-col",{staticClass:"marl",attrs:{span:4}},[a("el-select",{attrs:{disabled:e.ifEdit,placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.areaData.streetId,callback:function(t){e.$set(e.areaData,"streetId",t)},expression:"areaData.streetId"}},[a("el-option",{attrs:{label:"无",value:"-1"}}),e._v(" "),e._l(e.streets,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1)],1)},staticRenderFns:[]};var p=a("/Xao")(c,d,!1,function(e){a("zimh")},"data-v-3e3eb6f6",null).exports,f=a("9rMa"),h={data:function(){return{formData:{type:"",province:"",city:"",zone:"",street:""},center:"",list:[],loading:!1}},mounted:function(){this.getMapData()},components:{mapArea:p},methods:{getMapData:function(){var e=this;return o()(s.a.mark(function t(){var a,r,i,n,l,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a={},e.loading=!0,0===e.formData.type)for(r in e.formData)a[r]=e.formData[r],a.type="";else a=e.formData;return t.next=7,e.$http.post("http://mp.17link.cc/user/position",a);case 7:i=t.sent,n=i.data.data,l=n.center,o=n.list,e.center=l.split(","),o.forEach(function(e){return e.position=e.position.split(",")}),e.list=o,e.drowEcharts(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0);case 18:case"end":return t.stop()}},t,e,[[0,15]])}))()},drowMap:function(){for(var e=new AMap.Map("container",{resizeEnable:!0,zoom:11,center:this.center}),t=0;t<this.list.length;t++){new AMap.Marker({position:this.list[t].position,title:this.list[t].title+": "+this.list[t].userNum}).setMap(e)}e.plugin(["AMap.ToolBar"],function(){e.addControl(new AMap.ToolBar)});var a=this;e.on("complete",function(){a.loading=!1})},drowEcharts:function(){this.loading=!1,this.myChart=echarts.init(document.getElementById("container"));var e=[],t={};this.list.forEach(function(t){e.push({name:t.title,value:1})}),this.list.forEach(function(e,a){t[e.title]=e.position});var a={backgroundColor:"#404a59",title:{text:"机构分布",left:"center",textStyle:{color:"#fff"}},tooltip:{trigger:"item",formatter:function(e){return""+e.name}},bmap:{center:this.center,zoom:11,roam:!0,mapStyle:{styleJson:[{featureType:"water",elementType:"all",stylers:{color:"#044161"}},{featureType:"land",elementType:"all",stylers:{color:"#004981"}},{featureType:"boundary",elementType:"geometry",stylers:{color:"#064f85"}},{featureType:"railway",elementType:"all",stylers:{visibility:"off"}},{featureType:"highway",elementType:"geometry",stylers:{color:"#004981"}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#005b96",lightness:1}},{featureType:"highway",elementType:"labels",stylers:{visibility:"off"}},{featureType:"arterial",elementType:"geometry",stylers:{color:"#004981"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#00508b"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"green",elementType:"all",stylers:{color:"#056197",visibility:"off"}},{featureType:"subway",elementType:"all",stylers:{visibility:"off"}},{featureType:"manmade",elementType:"all",stylers:{visibility:"off"}},{featureType:"local",elementType:"all",stylers:{visibility:"off"}},{featureType:"arterial",elementType:"labels",stylers:{visibility:"off"}},{featureType:"boundary",elementType:"geometry.fill",stylers:{color:"#029fd4"}},{featureType:"building",elementType:"all",stylers:{color:"#1a5787"}},{featureType:"label",elementType:"all",stylers:{visibility:"off"}}]}},series:[{name:"机构",type:"scatter",coordinateSystem:"bmap",data:function(e){for(var a=[],r=0;r<e.length;r++){var i=t[e[r].name];i&&a.push({name:e[r].name,value:i.concat(e[r].value)})}return a}(e),symbolSize:function(e){return 10*e[2]},label:{normal:{formatter:"{b}",position:"right",show:!1},emphasis:{show:!1}},itemStyle:{normal:{color:"#ddb926"}}},{name:"",type:"effectScatter",coordinateSystem:"bmap",data:[{name:"成都",value:[104.08139,30.658059,10]}],symbolSize:function(e){return 20},showEffectOn:"emphasis",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#f4e925",shadowBlur:10,shadowColor:"#333"}},zlevel:1}]};this.myChart.setOption(a)},selectChange:function(e){console.log(e),this.formData.province=e.provinceName,this.formData.city=e.cityName,this.formData.zone=e.areaName,this.formData.street=e.streetName,this.getMapData()}},computed:i()({},Object(f.b)(["isOrg"]))},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.formData,inline:"","label-width":"100px","label-position":"left"}},[a("el-row",[a("mapArea",{ref:"area",attrs:{ifEdit:e.isOrg,title:"区域位置",curNum:"0"},on:{"select-change":e.selectChange}})],1),e._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"老人状况"}},[a("el-radio-group",{on:{change:e.getMapData},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(["全部","高龄","独居","空巢","失独"],function(t,r){return a("el-radio",{key:r,attrs:{label:r}},[e._v(e._s(t))])}))],1)],1)],1),e._v(" "),a("el-row",[a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],attrs:{id:"container"}})])],1)},staticRenderFns:[]};var u=a("/Xao")(h,m,!1,function(e){a("0t/8")},"data-v-5d6d59d0",null);t.default=u.exports},P14Q:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.marl[data-v-3e3eb6f6] {\n  margin-left: 10px;\n}\n",""])},WLi6:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n#container[data-v-5d6d59d0] {\n  height: 700px;\n  width: 90%;\n  margin: 0 auto;\n}\n",""])},zimh:function(e,t,a){var r=a("P14Q");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("8bSs")("6f1ac420",r,!0)}});